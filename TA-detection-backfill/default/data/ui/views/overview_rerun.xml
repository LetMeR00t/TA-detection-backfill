
        <dashboard version="2" theme="light" hiddenElements="{&quot;hideEdit&quot;:false,&quot;hideOpenInSearch&quot;:false,&quot;hideExport&quot;:false}">
            <label>Overview - Rerun</label>
            <description></description>
            <definition><![CDATA[{"visualizations":{"viz_N6x9M18w":{"type":"splunk.table","dataSources":{"primary":"ds_50m3Vqjt"},"description":"Backfills done over the period","title":"[Audit logs] Jobs history from the internal logs","options":{"columnFormat":{"Status":{"data":"> table | seriesByName(\"Status\") | formatByType(StatusColumnFormatEditorConfig)","rowColors":"> table | seriesByName('Status') | pick(StatusRowColorsEditorConfig)","rowBackgroundColors":"> table | seriesByName(\"Status\") | matchValue(StatusRowBackgroundColorsEditorConfig)"}}},"context":{"StatusColumnFormatEditorConfig":{"string":{"unitPosition":"after"}},"StatusRowColorsEditorConfig":["#3c444d"],"StatusRowBackgroundColorsEditorConfig":[{"match":"completed","value":"#55C169"},{"match":"failed","value":"#D41F1F"},{"match":"success","value":"#118832"}]}},"viz_bIa4sycM":{"type":"splunk.column","options":{"legendDisplay":"bottom"},"dataSources":{"primary":"ds_676vQq42"},"title":"Detection backfills run over the period","description":"Timechart"},"viz_ac0leGvM":{"type":"splunk.table","options":{"count":5,"columnFormat":{"Priority":{"data":"> table | seriesByName(\"Priority\") | formatByType(PriorityColumnFormatEditorConfig)","rowColors":"> table | seriesByName(\"Priority\") | pick(PriorityRowColorsEditorConfig)","rowBackgroundColors":"> table | seriesByName(\"Priority\") | rangeValue(PriorityRowBackgroundColorsEditorConfig)"}}},"dataSources":{"primary":"ds_TY2Z006V"},"context":{"PriorityColumnFormatEditorConfig":{"number":{"thousandSeparated":false,"unitPosition":"after"}},"PriorityRowColorsEditorConfig":["#ffffff"],"PriorityRowBackgroundColorsEditorConfig":[{"value":"#D41F1F","to":1},{"value":"#D94E17","from":1,"to":2},{"value":"#CBA700","from":2,"to":3},{"value":"#1182F3","from":3}]},"title":"[Backlog] Next 5 backfills to be rerun","description":"Detection backfill identified in the backlog as the 5 next important backfills to be run"},"viz_Ufytp5G8":{"type":"splunk.singlevalue","dataSources":{"primary":"ds_2RBpw1PP"},"title":"Detection backfills executed over the period","description":"Total count"},"viz_1EKlMJaS":{"type":"splunk.singlevalue","dataSources":{"primary":"ds_qMKopWpu"},"title":"[Backlog] Remaining backfills on the backlog to be rerun","description":"Total count"},"viz_fqnVM5O5":{"type":"splunk.singlevalue","title":"[Backlog] Estimated time before all remaining backfills are executed","description":"Calculated with the current settings - Only working if it's scheduled to be run over minutes or hours and continuously","dataSources":{"primary":"ds_MDgGVnma"}},"viz_78zSOBar":{"type":"splunk.pie","dataSources":{"primary":"ds_GIGEu6nv"},"showProgressBar":false,"showLastUpdated":false,"options":{"seriesColors":["#D41F1F","#D94E17","#CBA700","1182F3"]},"title":"[Backlog] Remaining backfills on the backlog to be rerun by priority"}},"dataSources":{"ds_CZxhNL2k":{"type":"ds.search","options":{"queryParameters":{"earliest":"$time.earliest$","latest":"$time.latest$"},"query":"index=_audit action=search provenance=rest event_count!=\"\" [search (index=_* OR index=cim_*) sourcetype=\"modular_alerts:detection_backfill*\" \"Job SID * dispatched\"\n| rex field=_raw \" Job SID '(?<sid_job>.*)' dispatched\"\n| table sid_job\n| eval search_id = \"'\"+sid_job+\"'\"\n| table search_id]\n| eval sid = coalesce(sid,replace(search_id,\"'\",\"\")), dispatch_time = coalesce(dispatch_time, exec_time), search_et = strftime(search_et,\"%Y-%m-%d %H:%M:%S %z\"), search_lt = strftime(search_lt,\"%Y-%m-%d %H:%M:%S %z\")\n| table _time, sourcetype, app, savedsearch_name, user, sid, search_et, search_lt, total_run_time, info, result_count","enableSmartSources":true},"name":"History"},"ds_50m3Vqjt":{"type":"ds.chain","options":{"extend":"ds_CZxhNL2k","query":"| sort 0 -_time\n| rename app as \"App\", sourcetype, as \"Sourcetype\", savedsearch_name as \"Savedsearch\", user as \"User\", sid as \"SID\", search_et as \"Search earliest time\", search_lt as \"Search latest time\", total_run_time as \"Duration\", info as \"Status\", result_count as \"Result count\""},"name":"History_table"},"ds_676vQq42":{"type":"ds.chain","options":{"extend":"ds_Rsk2CDw1","query":"| timechart span=5min count by $dd_YId2FDo6$"},"name":"Audit_logs_timechart"},"ds_rz2mQMs1":{"type":"ds.search","options":{"queryParameters":{"earliest":"$time.earliest$","latest":"$time.latest$"},"query":"| inputlookup detection_backfill_rerun_backlog\n| eval dispatch_time = strftime(dispatch_time,\"%Y-%m-%d %H:%M:%S %z\"), bf_created_time = strftime(bf_created_time,\"%Y-%m-%d %H:%M:%S %z\")\n| table batch_name, bf_batch_id, batch_priority, app, savedsearch, dispatch_time, bf_created_time, bf_created_author"},"name":"Backfill"},"ds_Rsk2CDw1":{"type":"ds.search","options":{"queryParameters":{"earliest":"$time.earliest$","latest":"$time.latest$"},"query":"(index=_* OR index=cim_*) sourcetype=\"modular_alerts:detection_backfill*\" \"[CAA-RTNB-050]\"\n| rex field=_raw \" Job for the savedsearch '(?<savedsearch>[^']+)' dispatched on the [^\\(]+ \\((?<dispatch_time>[^\\)]+)\\) was created. Job SID '(?<sid>[^']+)' dispatched from backfill uid '(?<bf_uid>[^']+)', batch '(?<batch_name>[^']+)' \\((?<bf_batch_id>[^\\)]+)\\)\"\n| table _time, savedsearch, dispatch_time, sid, bf_uid, batch_name, bf_batch_id"},"name":"Audit logs for RTNB-050"},"ds_2RBpw1PP":{"type":"ds.chain","options":{"extend":"ds_CZxhNL2k","query":"| stats count"},"name":"History_count"},"ds_TY2Z006V":{"type":"ds.chain","options":{"extend":"ds_rz2mQMs1","query":"| head 5\n| rename app as \"App\", savedsearch as \"Savedsearch\", bf_batch_id as \"Batch ID\", batch_name as \"Batch name\", bf_created_author as \"Batch created by\", bf_created_time as \"Batch created on\", batch_priority as \"Priority\", dispatch_time as \"Will be rerun on (dispatch time)\""},"name":"Backfill_next_5"},"ds_qMKopWpu":{"type":"ds.chain","options":{"extend":"ds_rz2mQMs1","query":"| stats count"},"name":"Backfill_count"},"ds_MDgGVnma":{"type":"ds.search","options":{"queryParameters":{"earliest":"$time.earliest$","latest":"$time.latest$"},"query":"| rest /servicesNS/-/-/saved/searches count=0 splunk_server=local\n| rename \"eai:acl.app\" as app\n| table app, title, search, cron_schedule\n| where match(app,\"TA-detection-backfill\") AND match(title,\"Run the next rerun scheduled detection backfill\")\n| rex field=search \"count=(?<count>\\d+)\"\n| rex field=cron_schedule \"^\\*(?:\\/(?<cron_minutes>\\d+))?\"\n| fillnull value=1 cron_minutes\n| table count, cron_minutes\n| append [\n    | inputlookup detection_backfill_rerun_backlog\n    | stats count as backlog]\n| stats values(count) as count, values(cron_minutes) as cron_minutes, values(backlog) as backlog\n| eval estimation = backlog*cron_minutes/count\n| eval estimation = if(estimation > 60, tostring(round(estimation/60,0))+\" hours \"+tostring(round(estimation%60))+\" minutes\", estimation+\" minutes\")\n| table estimation"},"name":"Estimation"},"ds_GIGEu6nv":{"type":"ds.chain","options":{"extend":"ds_rz2mQMs1","query":"| append\n    [| makeresults count=5\n    | eval id = 1 \n    | accum id as id\n    | eval id = id - 1\n    | rename id as batch_priority\n    | table batch_priority]\n| stats count by batch_priority\n| eval count = count - 1\n| eval batch_priority = case(batch_priority==0,\"Highest (0)\",batch_priority==1,\"High (1)\",batch_priority==2,\"Medium (2)\",batch_priority==3,\"Low (3)\",batch_priority==4,\"Lowest (4)\",1==1,batch_priority)"},"name":"Backfill_count_by_priority"}},"defaults":{"dataSources":{"ds.search":{"options":{"queryParameters":{}}}}},"inputs":{"input_1":{"type":"input.timerange","title":"Time","options":{"token":"time","defaultValue":"-24h@h,now"}},"input_8m0vH881":{"options":{"items":[{"label":"Savedsearch","value":"savedsearch"},{"label":"Batch name","value":"batch_name"}],"defaultValue":"savedsearch","token":"dd_YId2FDo6"},"title":"Chart - Show by","type":"input.dropdown"}},"layout":{"type":"grid","options":{"submitButton":false,"height":1162},"structure":[{"item":"viz_Ufytp5G8","type":"block","position":{"x":0,"y":0,"w":430,"h":280}},{"item":"viz_78zSOBar","type":"block","position":{"x":0,"y":280,"w":1200,"h":451}},{"item":"viz_bIa4sycM","type":"block","position":{"x":0,"y":731,"w":1200,"h":458}},{"item":"viz_N6x9M18w","type":"block","position":{"x":0,"y":1189,"w":1200,"h":385}},{"item":"viz_ac0leGvM","type":"block","position":{"x":0,"y":1574,"w":1200,"h":311}},{"item":"viz_1EKlMJaS","type":"block","position":{"x":430,"y":0,"w":349,"h":280}},{"item":"viz_fqnVM5O5","type":"block","position":{"x":779,"y":0,"w":421,"h":280}}],"globalInputs":["input_1","input_8m0vH881"]},"description":"","title":"Overview - Rerun"}]]></definition>
            <assets><![CDATA[{}]]></assets>
        </dashboard>