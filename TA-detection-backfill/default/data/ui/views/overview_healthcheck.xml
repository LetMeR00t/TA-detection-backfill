
        <dashboard version="2" theme="light" hiddenElements="{&quot;hideEdit&quot;:false,&quot;hideOpenInSearch&quot;:false,&quot;hideExport&quot;:false}">
            <label>Overview - Healthcheck</label>
            <description>This dashboards gives you a summary on the &quot;Healthcheck&quot; activity performed by this application</description>
            <definition><![CDATA[{"visualizations":{"viz_bIa4sycM":{"type":"splunk.column","options":{"legendDisplay":"bottom"},"dataSources":{"primary":"ds_RoVKQMpQ"},"title":"Healthcheck jobs run over the period","description":"Timechart"},"viz_ac0leGvM":{"type":"splunk.table","options":{"count":5,"columnFormat":{"Priority":{"data":"> table | seriesByName(\"Priority\") | formatByType(PriorityColumnFormatEditorConfig)","rowColors":"> table | seriesByName(\"Priority\") | pick(PriorityRowColorsEditorConfig)","rowBackgroundColors":"> table | seriesByName(\"Priority\") | rangeValue(PriorityRowBackgroundColorsEditorConfig)"}}},"dataSources":{"primary":"ds_TY2Z006V"},"context":{"PriorityColumnFormatEditorConfig":{"number":{"thousandSeparated":false,"unitPosition":"after"}},"PriorityRowColorsEditorConfig":["#ffffff"],"PriorityRowBackgroundColorsEditorConfig":[{"value":"#D41F1F","to":1},{"value":"#D94E17","from":1,"to":2},{"value":"#CBA700","from":2,"to":3},{"value":"#1182F3","from":3}]},"title":"[Backlog] Next 5 backfills to be rerun","description":"Detection backfill identified in the backlog as the 5 next important backfills to be run"},"viz_Ufytp5G8":{"type":"splunk.singlevalue","dataSources":{"primary":"ds_CabpPNpN"},"title":"Healthcheck jobs executed over the period","description":"Total count"},"viz_1EKlMJaS":{"type":"splunk.singlevalue","dataSources":{"primary":"ds_qMKopWpu"},"title":"[Backlog] Remaining healthcheck jobs on the backlog to be rerun","description":"Total count"},"viz_fqnVM5O5":{"type":"splunk.singlevalue","title":"[Backlog] Estimated time before all remaining healthcheck jobs are executed","description":"Calculated with the current settings - Only working if it's scheduled to be run over minutes or hours and continuously","dataSources":{"primary":"ds_MDgGVnma"}},"viz_78zSOBar":{"type":"splunk.pie","dataSources":{"primary":"ds_Qh0RYzTL"},"showProgressBar":false,"showLastUpdated":false,"options":{"seriesColors":["#D41F1F","#D94E17","#CBA700","1182F3"]},"title":"[Backlog] Remaining healthcheck jobs on the backlog by priority"}},"dataSources":{"ds_rz2mQMs1":{"type":"ds.search","options":{"queryParameters":{"earliest":"$time.earliest$","latest":"$time.latest$"},"query":"| inputlookup detection_backfill_healthcheck_backlog\n| table hc_uid, app,savedsearch_name,batch_name,batch_priority,hc_created_author,hc_created_time,orig_exec_time,orig_scan_count,orig_event_count,,orig_result_count,,orig_search_et,orig_search_lt"},"name":"ds_healthcheck_backlog"},"ds_TY2Z006V":{"type":"ds.chain","options":{"extend":"ds_rz2mQMs1","query":"| head 5\n| rename app as \"App\", savedsearch_name as \"Savedsearch\", bf_batch_id as \"Batch ID\", batch_name as \"Batch name\", hc_created_author as \"Batch created by\", hc_created_time as \"Batch created on\", batch_priority as \"Priority\", orig_scan_count as \"Original scan count\", orig_event_count as \"Original event count\", orig_result_count as \"Original result count\", hc_uid as \"UID\", orig_exec_time as \"Original execution time\", orig_search_et as \"Original earliest time\", orig_search_lt as \"Original latest time\", orig_search_id as \"Original SID\""},"name":"ds_healthcheck_backlog_next_5"},"ds_qMKopWpu":{"type":"ds.chain","options":{"extend":"ds_rz2mQMs1","query":"| stats count"},"name":"ds_healthcheck_backlog_count"},"ds_MDgGVnma":{"type":"ds.search","options":{"queryParameters":{"earliest":"$time.earliest$","latest":"$time.latest$"},"query":"| rest /servicesNS/-/-/saved/searches count=0 splunk_server=local\n| rename \"eai:acl.app\" as app\n| table app, title, search, cron_schedule\n| where match(app,\"TA-detection-backfill\") AND match(title,\"Run the next healthcheck jobs from the backlog\")\n| rex field=search \"count=(?<count>\\d+)\"\n| rex field=cron_schedule \"^\\*(?:\\/(?<cron_minutes>\\d+))?\"\n| fillnull value=1 cron_minutes\n| table count, cron_minutes\n| append [\n    | inputlookup detection_backfill_healthcheck_backlog\n    | stats count as backlog]\n| stats values(count) as count, values(cron_minutes) as cron_minutes, values(backlog) as backlog\n| eval estimation = backlog*cron_minutes/count\n| eval estimation = if(estimation > 60, tostring(round(estimation/60,0))+\" hours \"+tostring(round(estimation%60))+\" minutes\", estimation+\" minutes\")\n| table estimation"},"name":"ds_healthcheck_backlog_estimation"},"ds_Qh0RYzTL":{"type":"ds.search","options":{"queryParameters":{"earliest":"$time.earliest$","latest":"$time.latest$"},"query":"(`get_detection_backfill_events` type=healthcheck:job_dispatched)\n| table _time, sid, batch_priority"},"name":"ds_healthcheck_jobs_dispatched"},"ds_CabpPNpN":{"type":"ds.chain","options":{"extend":"ds_Qh0RYzTL","query":"| stats count"},"name":"ds_healthcheck_jobs_dispatched_count"},"ds_RoVKQMpQ":{"type":"ds.chain","options":{"extend":"ds_Qh0RYzTL","query":"| timechart span=1h count"},"name":"ds_healthcheck_jobs_dispatched_timechart"},"ds_kpyWHvKA":{"type":"ds.chain","options":{"extend":"ds_Qh0RYzTL","query":"| append\n    [| makeresults count=5\n    | eval id = 1 \n    | accum id as idÂ²\n    | eval id = id - 1\n    | rename id as batch_priority\n    | table batch_priority]\n| stats count by batch_priority\n| eval count = count - 1\n| eval batch_priority = case(batch_priority==0,\"Highest (0)\",batch_priority==1,\"High (1)\",batch_priority==2,\"Medium (2)\",batch_priority==3,\"Low (3)\",batch_priority==4,\"Lowest (4)\",1==1,batch_priority)"},"name":"ds_healthcheck_jobs_dispatched_stats_by_priority"}},"defaults":{"dataSources":{"ds.search":{"options":{"queryParameters":{}}}}},"inputs":{"input_1":{"type":"input.timerange","title":"Time","options":{"token":"time","defaultValue":"-24h@h,now"}}},"layout":{"type":"grid","options":{"submitButton":false,"height":1162},"structure":[{"item":"viz_ac0leGvM","type":"block","position":{"x":0,"y":1189,"w":1200,"h":311}},{"item":"viz_Ufytp5G8","type":"block","position":{"x":0,"y":0,"w":430,"h":280}},{"item":"viz_78zSOBar","type":"block","position":{"x":0,"y":280,"w":1200,"h":451}},{"item":"viz_bIa4sycM","type":"block","position":{"x":0,"y":731,"w":1200,"h":458}},{"item":"viz_1EKlMJaS","type":"block","position":{"x":430,"y":0,"w":349,"h":280}},{"item":"viz_fqnVM5O5","type":"block","position":{"x":779,"y":0,"w":421,"h":280}}],"globalInputs":["input_1"]},"description":"This dashboards gives you a summary on the \"Healthcheck\" activity performed by this application","title":"Overview - Healthcheck"}]]></definition>
            <assets><![CDATA[{}]]></assets>
        </dashboard>