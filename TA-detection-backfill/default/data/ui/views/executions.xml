
        <dashboard version="2" theme="light" hiddenElements="{&quot;hideEdit&quot;:false,&quot;hideOpenInSearch&quot;:false,&quot;hideExport&quot;:false}">
            <label>3. ðŸ“Š Executions</label>
            <description>This dashboard is used to track the execution and results of your rerun backfills.</description>
            <definition><![CDATA[{"visualizations":{"viz_table_1":{"type":"splunk.table","options":{"count":100,"dataOverlayMode":"none","drilldown":"none","percentagesRow":false,"rowNumbers":false,"totalsRow":false,"wrap":true,"columnFormat":{"Status":{"data":"> table | seriesByName(\"Status\") | formatByType(StatusColumnFormatEditorConfig)","rowColors":"> table | seriesByName('Status') | pick(StatusRowColorsEditorConfig)","rowBackgroundColors":"> table | seriesByName(\"Status\") | matchValue(StatusRowBackgroundColorsEditorConfig)"},"Duration":{"data":"> table | seriesByName(\"Duration\") | formatByType(DurationColumnFormatEditorConfig)"},"Result count":{"data":"> table | seriesByName(\"Result count\") | formatByType(Result_countColumnFormatEditorConfig)","rowColors":"> table | seriesByName('Result count') | pick(Result_countRowColorsEditorConfig)","rowBackgroundColors":"> table | seriesByName(\"Result count\") | rangeValue(Result_countRowBackgroundColorsEditorConfig)"}}},"dataSources":{"primary":"ds_search_2"},"showProgressBar":true,"title":"[Audit logs] Jobs history from the internal logs","context":{"StatusColumnFormatEditorConfig":{"string":{"unitPosition":"after"}},"StatusRowColorsEditorConfig":["#3c444d"],"StatusRowBackgroundColorsEditorConfig":[{"match":"completed","value":"#55C169"},{"match":"failed","value":"#e94d4d"},{"match":"success","value":"#118832"},{"match":"bad_request","value":"#e94d4d"}],"DurationColumnFormatEditorConfig":{"number":{"thousandSeparated":false,"unitPosition":"after","unit":"s"}},"Result_countColumnFormatEditorConfig":{"number":{"thousandSeparated":false,"unitPosition":"after"}},"Result_countRowColorsEditorConfig":["#3c444d"],"Result_countRowBackgroundColorsEditorConfig":[{"value":"#027DA6","to":1},{"value":"#cba700","from":1,"to":20},{"value":"#d97a0d","from":20,"to":40},{"value":"#d94e17","from":40,"to":60},{"value":"#E94D4D","from":60,"to":100},{"value":"#B85FE5","from":100}]},"eventHandlers":[{"type":"drilldown.customUrl","options":{"url":"/app/TA-detection-backfill/search?sid=$row.SID.value$","newTab":true}}],"description":"You can click on a row to open the job"},"viz_peLrD7iH":{"type":"splunk.singlevalue","options":{"majorColor":"#ffffff","backgroundColor":"#F2D130"},"dataSources":{"primary":"ds_tWU8t2mm"}},"viz_bfRT0ZEK":{"type":"splunk.sankey","dataSources":{"primary":"ds_DFqOImyS"},"title":"Number of results found per savedsearch","options":{"colorMode":"dynamic","linkColors":"> linkValues | rangeValue(linkColorsEditorConfig)"},"context":{"linkColorsEditorConfig":[{"value":"#027DA6","to":0},{"value":"#669922","from":0,"to":40},{"value":"#9D9F0D","from":40,"to":60},{"value":"#D97A0D","from":60,"to":80},{"value":"#D94E17","from":80,"to":90},{"value":"#D41F1F","from":90}]}},"viz_kxK8jVpL":{"type":"splunk.column","options":{"legendDisplay":"bottom"},"dataSources":{"primary":"ds_udkI8o9x"},"description":"","title":"Execution time of the backfills"},"viz_5KMC5LYb":{"type":"splunk.column","options":{"legendDisplay":"bottom"},"dataSources":{"primary":"ds_2IEAmymF"},"showProgressBar":false,"showLastUpdated":false},"viz_s0HvIMoW":{"type":"splunk.singlevalueradial","title":"Batch progress","dataSources":{"primary":"ds_la13Zq1e"},"options":{"majorColor":"> majorValue | rangeValue(majorColorEditorConfig)","unit":"%"},"context":{"majorColorEditorConfig":[{"to":20,"value":"#D41F1F"},{"from":20,"to":40,"value":"#D94E17"},{"from":40,"to":60,"value":"#CBA700"},{"from":60,"to":80,"value":"#669922"},{"from":80,"value":"#118832"}]},"description":"This represents the percentage of searches already executed in relation to the entire batch."},"viz_glnetHVu":{"type":"splunk.singlevalue","dataSources":{"primary":"ds_myJjiv1q"},"title":"[Backlog] Remaining backfills on the backlog to be rerun for the selected batch","description":"Total count"},"viz_cJ9xcTsi":{"type":"splunk.singlevalue","dataSources":{"primary":"ds_pySaMysY"},"title":"Batch results","description":"This represents the number of events that matched the rerun searches for the selected batch"}},"dataSources":{"ds_batches":{"type":"ds.search","options":{"query":"(index=_* OR index=cim_*) sourcetype=\"modular_alerts:detection_backfill*\" \"[CAA-RTNB-050]\"\n| rex field=_raw \" Job for the savedsearch '(?<app>[^\\/]+)\\/(?<savedsearch_name>[^']+)' dispatched was created as if the current time was [^\\(]+ \\((?<dispatch_time>[^\\)]+)\\). Job SID '(?<sid>[^']+)' dispatched from backfill uid '(?<bf_uid>[^']+)', batch '(?<batch_name>[^']+)' \\((?<bf_batch_id>[^\\)]+)\\)\"","queryParameters":{"earliest":"$timerange.earliest$","latest":"$timerange.latest$"}},"name":"ds_batches"},"ds_jobs":{"type":"ds.search","options":{"query":"index=_audit action=search provenance=rest event_count!=\"\" [search (index=_* OR index=cim_*) sourcetype=\"modular_alerts:detection_backfill*\" \"[CAA-RTNB-050]\" \"$dd_MkgcSJjg$\"\n| rex field=_raw \" Job for the savedsearch '(?<app>[^\\/]+)\\/(?<savedsearch_name>[^']+)' dispatched was created as if the current time was [^\\(]+ \\((?<dispatch_time>[^\\)]+)\\). Job SID '(?<sid>[^']+)' dispatched from backfill uid '(?<bf_uid>[^']+)', batch '(?<batch_name>[^']+)' \\((?<bf_batch_id>[^\\)]+)\\)\"\n| eval search_id = \"'\"+sid+\"'\" | table search_id]\n| rex field=_raw \"search_et=(?<search_et>[^,]+), search_lt=(?<search_lt>[^,]+)\"\n| eval sid = coalesce(sid,replace(search_id,\"'\",\"\")), dispatch_time = coalesce(dispatch_time, exec_time), run_time = coalesce(run_time, total_run_time), status = coalesce(status,info), search_et = strftime(search_et,\"%Y-%m-%d %H:%M:%S %z\"), search_lt = strftime(search_lt,\"%Y-%m-%d %H:%M:%S %z\")\n| table _time, app, savedsearch_name, user, sid, search_et, search_lt, run_time, status, result_count\n| sort 0 -_time","queryParameters":{"earliest":"$timerange.earliest$","latest":"$timerange.latest$"}},"name":"ds_jobs"},"ds_search_1":{"type":"ds.chain","options":{"query":"| eval batch_name = \"'\"+batch_name+\"' (\"+bf_batch_id+\")\"\n| stats count by bf_batch_id, batch_name","extend":"ds_batches","enableSmartSources":true},"name":"Batches_list"},"ds_search_2":{"type":"ds.chain","options":{"query":"| sort 0 -result_count\n| rename app as \"App\", sourcetype, as \"Sourcetype\", savedsearch_name as \"Savedsearch\", user as \"User\", sid as \"SID\", dispatch_time as \"Dispatch time\", run_time as \"Duration\", status as \"Status\", result_count as \"Result count\", search_et as \"Earliest time\", search_lt as \"Latest time\"","extend":"ds_jobs","enableSmartSources":true},"name":"Jobs_details"},"ds_DFqOImyS":{"type":"ds.chain","options":{"extend":"ds_jobs","query":"| eval savedsearch = app+\"/\"+savedsearch_name\n| stats count by savedsearch, result_count"},"name":"Jobs_sankey"},"ds_udkI8o9x":{"type":"ds.chain","options":{"extend":"ds_search_2","query":"| timechart span=5min count by Savedsearch"},"name":"Jobs_timechart"},"ds_2IEAmymF":{"type":"ds.chain","options":{"extend":"ds_jobs","query":"| stats count by savedsearch_name, result_count\n| eval {savedsearch_name} = count\n| fields - savedsearch_name, count\n| stats values(*) as * by result_count\n| rename result_count as \"Result count\""},"name":"Jobs_bar"},"ds_YZEJB1L5":{"type":"ds.search","options":{"queryParameters":{"earliest":"$timerange.earliest$","latest":"$timerange.latest$"},"query":"| inputlookup detection_backfill_rerun_backlog\n| eval dispatch_time = strftime(dispatch_time,\"%Y-%m-%d %H:%M:%S %z\"), bf_created_time = strftime(bf_created_time,\"%Y-%m-%d %H:%M:%S %z\")\n| table batch_name, bf_batch_id, batch_priority, app, savedsearch, dispatch_time, bf_created_time, bf_created_author"},"name":"ds_backfills"},"ds_myJjiv1q":{"type":"ds.chain","options":{"extend":"ds_YZEJB1L5","query":"| search bf_batch_id=\"$dd_MkgcSJjg$\"\n| stats count"},"name":"Backfill_remaining"},"ds_la13Zq1e":{"type":"ds.chain","options":{"extend":"ds_jobs","query":"| stats count as count_executed\n| append\n    [| inputlookup detection_backfill_rerun_backlog where bf_batch_id=\"$dd_MkgcSJjg$\" | stats count as count_backfill]\n| stats values(count_executed) as count_executed, values(count_backfill) as count_backfill\n| eval total = count_executed+count_backfill, progress = count_executed/total*100\n| table progress"},"name":"Backfill_progress"},"ds_tWU8t2mm":{"type":"ds.chain","options":{"extend":"ds_batches","query":"| search bf_batch_id=\"$dd_MkgcSJjg$\"\n| stats count by batch_name\n| eval batch_name = if(\"$dd_MkgcSJjg$\"==\"*\",\"All executed batches over the given period\",batch_name)\n| table batch_name"},"name":"Batch_selected_name"},"ds_pySaMysY":{"type":"ds.chain","options":{"extend":"ds_jobs","query":"\n| stats sum(result_count)"},"name":"Jobs_total_result_count"}},"defaults":{"dataSources":{"ds.search":{"options":{"queryParameters":{}}}}},"inputs":{"input_1":{"type":"input.timerange","title":"Time range","options":{"token":"timerange","defaultValue":"-24h@h,now"}},"input_OjxdHIyr":{"options":{"items":">frame(label, value) | prepend(formattedStatics) | objects()","token":"dd_MkgcSJjg","defaultValue":"*"},"title":"Batch name","type":"input.dropdown","dataSources":{"primary":"ds_search_1"},"context":{"formattedConfig":{"number":{"prefix":""}},"formattedStatics":">statics | formatByType(formattedConfig)","statics":[["Any"],["*"]],"label":">primary | seriesByName(\"batch_name\") | renameSeries(\"label\") | formatByType(formattedConfig)","value":">primary | seriesByName(\"bf_batch_id\") | renameSeries(\"value\") | formatByType(formattedConfig)"}}},"layout":{"type":"grid","options":{"submitButton":false,"height":500},"structure":[{"item":"viz_peLrD7iH","type":"block","position":{"x":0,"y":0,"w":1200,"h":66}},{"item":"viz_cJ9xcTsi","type":"block","position":{"x":0,"y":66,"w":302,"h":266}},{"item":"viz_5KMC5LYb","type":"block","position":{"x":0,"y":332,"w":1200,"h":430}},{"item":"viz_bfRT0ZEK","type":"block","position":{"x":0,"y":762,"w":1200,"h":566}},{"item":"viz_table_1","type":"block","position":{"x":0,"y":1328,"w":1200,"h":920}},{"item":"viz_kxK8jVpL","type":"block","position":{"x":0,"y":2248,"w":1200,"h":440}},{"item":"viz_s0HvIMoW","type":"block","position":{"x":302,"y":66,"w":586,"h":266}},{"item":"viz_glnetHVu","type":"block","position":{"x":888,"y":66,"w":312,"h":266}}],"globalInputs":["input_1","input_OjxdHIyr"]},"description":"This dashboard is used to track the execution and results of your backfills.","title":"3. ðŸ“Š Executions"}]]></definition>
            <assets><![CDATA[{}]]></assets>
        </dashboard>